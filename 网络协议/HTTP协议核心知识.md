# [HTTP协议核心知识](https://www.cnblogs.com/wkfvawl/p/14907028.html)

参考《图解HTTP》

视频：[https://www.bilibili.com/video/BV1NK411w7mc](https://www.bilibili.com/video/BV1NK411w7mc?p=18&spm_id_from=pageDriver)

本文适合作为网络爬虫和自动化测试的前导知识学习

## 一、了解Web和网络基础

### 1、Web万维网和HTTP协议

使用HTTP协议访问万维网

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620160802823-750249325.png)

 WWW万维网的构成

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620160923667-948971586.png)

### ![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620160946174-991155283.png)2、HTTP发展历程和版本

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620161238959-2085334184.png)

### 3、当下HTTP协议应用现状

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620161345659-525751683.png)

## 二、与HTTP相关的协议

### 1、TCP/IP协议族

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620161716275-423056830.png)

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620162018692-2083528729.png)

利用TCP/IP协议族进行网络通信时，会通过分层顺序与对方进行通信。发送端从应用层往下走，接收端则从链路层网上走。

我们用 HTTP 举例来说明，首先作为发送端的客户端在应用层 （HTTP 协议）发出一个想看某个 Web 页面的 HTTP 请求。接着，为了传输方便，在传输层（TCP 协议）把从应用层处收到的数据（HTTP 请求报文）进行分割，并在各个报文上打上标记序号及端 口号后转发给网络层。在网络层（IP 协议），增加作为通信目的地的 MAC 地址后转发给链路层。这样一来，发往网络的通信请求就准备齐全了。接收端的服务器在链路层接收到数据，按序往上层发送，一直到应用 层。当传输到应用层，才能算真正接收到由客户端发送过来的 HTTP 请求。

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620162608185-950156585.png)

发送端在层与层之间传输数据时，每经过一层时必定会被打上一个该 层所属的首部信息。反之，接收端在层与层传输数据时，每经过一层 时会把对应的首部消去。

这种把数据信息包装起来的做法称为**封装（encapsulate）**。

IP网际协议

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620162814817-629793494.png)

IP 地址指明了节点被分配到的地址，MAC 地址是指网卡所属的固定 地址。IP 地址可以和 MAC地址进行配对。IP 地址可变换，但 MAC 地址基本上不会更改。

使用 ARP 协议凭借 MAC 地址进行通信

按层次分，TCP 位于传输层，提供可靠的字节流服务。 所谓的字节流服务（Byte Stream Service）是指，为了方便传输，将大 块数据分割成以报文段（segment）为单位的数据包进行管理。而可 靠的传输服务是指，能够把数据准确可靠地传给对方。一言以蔽之， TCP 协议为了更容易传送大数据才把数据分割，而且 TCP 协议能够 确认数据最终是否送达到对方。 确保数据能到达目标 为了准确无误地将数据送达目标处，TCP 协议采用了三次握手 （three-way handshaking）策略。用 TCP 协议把数据包送出去后，TCP 不会对传送后的情况置之不理，它一定会向对方确认是否成功送达。
握手过程中使用了 TCP 的标志（flag） —— SYN（synchronize） 和 ACK（acknowledgement）。 发送端首先发送一个带 SYN 标志的数据包给对方。接收端收到后， 回传一个带有 SYN/ACK 标志的数据包以示传达确认信息。最后，发 送端再回传一个带 ACK 标志的数据包，代表“握手”结束。 若在握手过程中某个阶段莫名中断，TCP 协议会再次以相同的顺序发送相同的数据包。

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620163154761-210006505.png)

### 2、DNS协议

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620163511822-65258298.png)

 

 

### 3、各个协议关系

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620164103696-1661743912.png)

 

 

### 3、SSL、HTTP协议

#### HTTP协议安全性不足

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620164725121-1486611400.png)

 

 

#### HTTP协议安全性解决方法

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620165016093-1284515872.png)

 

 

## 三、HTTP协议

### 1、HTTP理解

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620170139725-1357707968.png)

### 2、URI与URL![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620171853827-342326932.png)

### 3、HTTP报文结构

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620172730630-2103269407.png)

### 4、八种请求方法

### ![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620173837727-213846488.png)5、HTTP状态码

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620174913653-1970411795.png)

 

| 状态码 | 状态码英文名称                  | 中文描述                                                     |
| ------ | ------------------------------- | ------------------------------------------------------------ |
| 100    | Continue                        | 继续。[客户端](http://www.dreamdu.com/webbuild/client_vs_server/)应继续其请求 |
| 101    | Switching Protocols             | 切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议，例如，切换到HTTP的新版本协议 |
|        |                                 |                                                              |
| 200    | OK                              | 请求成功。一般用于GET与POST请求                              |
| 201    | Created                         | 已创建。成功请求并创建了新的资源                             |
| 202    | Accepted                        | 已接受。已经接受请求，但未处理完成                           |
| 203    | Non-Authoritative Information   | 非授权信息。请求成功。但返回的meta信息不在原始的服务器，而是一个副本 |
| 204    | No Content                      | 无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档 |
| 205    | Reset Content                   | 重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。可通过此返回码清除浏览器的表单域 |
| 206    | Partial Content                 | 部分内容。服务器成功处理了部分GET请求                        |
|        |                                 |                                                              |
| 300    | Multiple Choices                | 多种选择。请求的资源可包括多个位置，相应可返回一个资源特征与地址的列表用于用户终端（例如：浏览器）选择 |
| 301    | Moved Permanently               | 永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替 |
| 302    | Found                           | 临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI |
| 303    | See Other                       | 查看其它地址。与301类似。使用GET和POST请求查看               |
| 304    | Not Modified                    | 未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源 |
| 305    | Use Proxy                       | 使用代理。所请求的资源必须通过代理访问                       |
| 306    | Unused                          | 已经被废弃的HTTP状态码                                       |
| 307    | Temporary Redirect              | 临时重定向。与302类似。使用GET请求重定向                     |
|        |                                 |                                                              |
| 400    | Bad Request                     | 客户端请求的语法错误，服务器无法理解                         |
| 401    | Unauthorized                    | 请求要求用户的身份认证                                       |
| 402    | Payment Required                | 保留，将来使用                                               |
| 403    | Forbidden                       | 服务器理解请求客户端的请求，但是拒绝执行此请求               |
| 404    | Not Found                       | 服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置"您所请求的资源无法找到"的个性页面 |
| 405    | Method Not Allowed              | 客户端请求中的方法被禁止                                     |
| 406    | Not Acceptable                  | 服务器无法根据客户端请求的内容特性完成请求                   |
| 407    | Proxy Authentication Required   | 请求要求代理的身份认证，与401类似，但请求者应当使用代理进行授权 |
| 408    | Request Time-out                | 服务器等待客户端发送的请求时间过长，超时                     |
| 409    | Conflict                        | 服务器完成客户端的 PUT 请求时可能返回此代码，服务器处理请求时发生了冲突 |
| 410    | Gone                            | 客户端请求的资源已经不存在。410不同于404，如果资源以前有现在被永久删除了可使用410代码，网站设计人员可通过301代码指定资源的新位置 |
| 411    | Length Required                 | 服务器无法处理客户端发送的不带Content-Length的请求信息       |
| 412    | Precondition Failed             | 客户端请求信息的先决条件错误                                 |
| 413    | Request Entity Too Large        | 由于请求的实体过大，服务器无法处理，因此拒绝请求。为防止客户端的连续请求，服务器可能会关闭连接。如果只是服务器暂时无法处理，则会包含一个Retry-After的响应信息 |
| 414    | Request-URI Too Large           | 请求的URI过长（URI通常为网址），服务器无法处理               |
| 415    | Unsupported Media Type          | 服务器无法处理请求附带的媒体格式                             |
| 416    | Requested range not satisfiable | 客户端请求的范围无效                                         |
| 417    | Expectation Failed              | 服务器无法满足Expect的请求头信息                             |
|        |                                 |                                                              |
| 500    | Internal Server Error           | 服务器内部错误，无法完成请求                                 |
| 501    | Not Implemented                 | 服务器不支持请求的功能，无法完成请求                         |
| 502    | Bad Gateway                     | 作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应 |
| 503    | Service Unavailable             | 由于超载或系统维护，服务器暂时的无法处理客户端的请求。延时的长度可包含在服务器的Retry-After头信息中 |
| 504    | Gateway Time-out                | 充当网关或代理的服务器，未及时从远端服务器获取请求           |
| 505    | HTTP Version not supported      | 服务器不支持请求的HTTP协议的版本，无法完成处理               |

### 6、HTTP首部

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620180309406-318412022.png)

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620180823179-19305523.png)

### 7、无状态协议![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620182005645-1987443313.png)

cookie session token的理解https://www.cnblogs.com/moyand/p/9047978.html

 

## 四、总结

![img](https://img2020.cnblogs.com/blog/1358881/202106/1358881-20210620182416000-1223647716.png)

 